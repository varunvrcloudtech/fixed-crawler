<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Web Scraper</title>
    <link rel="stylesheet" href="/src/dashboard.css">
</head>
<body>
    <nav class="navbar">
        <h1>ğŸŒ Web Scraper</h1>
        <div class="user-info">
            <img id="userAvatar" class="user-avatar" src="" alt="User" style="display: none;">
            <span id="userDisplay">Welcome</span>
            <button class="btn-logout" onclick="logout()">Logout</button>
        </div>
    </nav>

    <div class="main-content">
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('realEstate')">ğŸ  Real Estate</button>
            <button class="tab-button" onclick="switchTab('general')">ğŸŒ Any Website</button>
            <button class="tab-button" onclick="switchTab('history')">ğŸ“š History</button>
        </div>

        <div class="scraper-card">
            <div id="realEstateTab" class="tab-content active">
                <div class="sub-tabs">
                    <button class="sub-tab-button active" onclick="switchRealEstateSubTab('scrape')">ğŸ” Scrape</button>
                    <button class="sub-tab-button" onclick="switchRealEstateSubTab('choices')">My Choices</button>
                </div>

                <div id="realEstateScrapeTab" class="sub-tab-content active">
                    <h2>ğŸ” Scrape Real Estate Listings</h2>

                    <div class="info-box" style="margin-bottom: 20px;">
                        <strong>ğŸ’¡ How it works:</strong> Enter a URL from a real estate website (already filtered with your preferences), and we'll extract property details. <strong>Important:</strong> The scraped data will come from whatever city/location is in the URL you provide (e.g., if you scrape a DC Zillow page, you'll get DC listings). The "Location" field below is optional metadata for organizing your saved data. For best results, use URLs from Zillow, Realtor.com, or Redfin with your search filters already applied.<br><br>
                        <strong style="color: #ff6b35;">âš ï¸ Note:</strong> Scraping is limited to the first 10 property records found on the page.
                    </div>

                    <div class="quick-links">
                        <button class="quick-link" onclick="setUrl('https://www.zillow.com/new-orleans-la/')">Zillow - New Orleans</button>
                        <button class="quick-link" onclick="setUrl('https://www.zillow.com/homes/for_rent/')">Zillow - Rentals</button>
                        <button class="quick-link" onclick="setUrl('https://www.realtor.com/')">Realtor.com</button>
                        <button class="quick-link" onclick="setUrl('https://www.redfin.com/')">Redfin</button>
                    </div>

                <div class="url-input-group">
                    <input type="url" id="scrapeUrl" placeholder="Enter URL to scrape (e.g., https://www.zillow.com/new-orleans-la/)" required>
                    <button class="btn-scrape" id="scrapeBtn" onclick="startScraping()">
                        ğŸš€ Scrape
                    </button>
                </div>

                <h3 style="margin: 20px 0 15px; color: #333; font-size: 16px;">Optional: Add Metadata & Filter Results</h3>
                <p style="color: #666; font-size: 13px; margin-bottom: 15px;">These parameters help organize your data and filter extracted listings by price.</p>

                <div class="form-row">
                    <div class="form-group">
                        <label for="location">ğŸ“ Location (City, State)</label>
                        <input type="text" id="location" placeholder="e.g., New Orleans, LA">
                    </div>

                    <div class="form-group">
                        <label for="propertyType">ğŸ¡ Property Type</label>
                        <select id="propertyType">
                            <option value="any">Any</option>
                            <option value="purchase">For Purchase</option>
                            <option value="rent">For Rent</option>
                            <option value="lease">For Lease</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="minPrice">ğŸ’° Min Price ($)</label>
                        <input type="number" id="minPrice" placeholder="e.g., 100000">
                    </div>

                    <div class="form-group">
                        <label for="maxPrice">ğŸ’° Max Price ($)</label>
                        <input type="number" id="maxPrice" placeholder="e.g., 500000">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="distanceFrom">ğŸ“Œ Distance From (Address/Place)</label>
                        <input type="text" id="distanceFrom" placeholder="e.g., Downtown New Orleans">
                    </div>

                    <div class="form-group">
                        <label for="maxDistance">ğŸš— Max Distance (miles)</label>
                        <input type="number" id="maxDistance" placeholder="e.g., 10">
                    </div>
                </div>
                </div>

                <div id="realEstateChoicesTab" class="sub-tab-content">
                    <h2>â­ My Choices</h2>
                    <p style="color: #666; margin-bottom: 20px;">View and manage your selected real estate properties.</p>
                    <div id="choicesContainer">
                        <div class="no-results">
                            <p>No choices saved yet. Scrape real estate data and add properties to your choices!</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="generalTab" class="tab-content">
                <h2>ğŸŒ Scrape Any Website</h2>

                <div class="quick-links">
                    <button class="quick-link" onclick="setGeneralUrl('https://news.ycombinator.com/')">Hacker News</button>
                    <button class="quick-link" onclick="setGeneralUrl('https://www.reddit.com/')">Reddit</button>
                    <button class="quick-link" onclick="setGeneralUrl('https://www.wikipedia.org/')">Wikipedia</button>
                    <button class="quick-link" onclick="setGeneralUrl('https://www.github.com/')">GitHub</button>
                </div>

                <div class="url-input-group">
                    <input type="url" id="generalScrapeUrl" placeholder="Enter any website URL (e.g., https://example.com)" required>
                    <button class="btn-scrape" id="generalScrapeBtn" onclick="startGeneralScraping()">
                        ğŸš€ Scrape
                    </button>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="scrapeFormat">ğŸ“„ Output Format</label>
                        <select id="scrapeFormat">
                            <option value="markdown">Markdown</option>
                            <option value="html">HTML</option>
                            <option value="both">Both</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="mainContentOnly">ğŸ“ Content Type</label>
                        <select id="mainContentOnly">
                            <option value="true">Main Content Only</option>
                            <option value="false">Full Page</option>
                        </select>
                    </div>
                </div>

                <div class="info-box">
                    <strong>ğŸ’¡ Tip:</strong> This mode extracts clean, structured content from any website. Perfect for blog posts, articles, documentation, or any web page you want to analyze.
                </div>
            </div>

            <div id="historyTab" class="tab-content">
                <h2>ğŸ“š Saved Scrapes</h2>
                <p style="color: #666; margin-bottom: 20px;">View and manage all your saved scrapes from the database.</p>
                <div id="historyContainer">
                    <div class="no-results">
                        <p>Loading history...</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="results-card">
            <h2>ğŸ“Š Results</h2>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Scraping website... This may take a moment.</p>
            </div>

            <div id="resultsContainer">
                <div class="no-results">
                    <p>No results yet. Enter a URL and click "Scrape" to get started.</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/dashboard.js"></script>
</body>
</html>
